# Highload Ozon

## Содержание
* ### [1. Тема, целевая аудитория](#1)
* ### [2. Расчет нагрузки](#2)
* ### [3. Глобальная балансировка](#3)

## 1. Тема, аудитория, функционал <a name="1"></a>

### Тема
Ozon — выход крупнейшего E-commerce России на рынок КНР.  
### Целевая аудитория  \[[1]( https://ozon.tech/)]
- Рынок КНР.
- Возрастная категория: 18-45 лет; 40% женщин, 60% мужчин.
- Уникальных пользователей:
	-  в месяц 70 млн. (MAU)
	-  в день 15 млн. (DAU)
- 500к заказов в сутки; 50к заказов в минуту в дни распродаж.
- Изменение статуса заказа до 5 раз в день.


### MVP
Функционал:
- Авторизация и личный кабинет (список заказов и их статусы).
- Каталог, страница товара.
- Корзина (просмотр, изменение), оформления заказа.
- Отзывы и рейтинг.
- Cервис отслеживания заказа:
	- Рассылка Push-уведомлений со статусом заказа.
	- Обновление данных о статусе от транспортных компаний.
---

## 2. Расчет нагрузки <a name="2"></a>
### Сценарий посещения сайта одним пользователем в течение дня

| Действие | Кол-во | В среднем |
| ---- | ---- | ---- |
| Авторизация | [0, 1]  | 0.5 |
| Просмотр отдельного товара,<br>каталога | [5, 55] | 30 |
| Добавление в корзину | [1, 5] | 3 |
| Отзыв и оценка | [0, 1] | 0.5 |
| Заказ товара | [0, 1] | 0.5 |
| Просмотр списка заказов | [1, 3] | 2 |

Средние количество действий за визит 37.
<br>
`37*DAU = 555 млн.`<br>
`555млн/(24*60*60) = 6500 RPS` - от пользователей

500к создаются в течение дня. Пусть в среднем жизненый цикл заказа 5 дней и его статус обновляется раз в сутки. Тогда действуюших заказов в среднем 2500к. 
`2500 RPS` - от логистики


### Объем изображений товаров
Ассортимент Ozon составил 250 млн товаров. Каждый товар содержит в среднем 4 фотографии, при этом каждое изображение весит в среднем 50 КБ. Отсюда получаем `50 * 4 * 250млн = 46,57 TБ`.

### Объем изображений в отзывах

Пусть 15% товаров имеют порядка 100 отзывов. И 1% отзывов из списка имеют [2, 7] фотографий. Тогда `250млн*0.15*(100*0.01*5) = 187.5млн` - изображений приходится на долю отзывов. Объём `187.5млн * 50 КБ = 8,73 ТБ`

---

## 3. Глобальная балансировка <a name="3"></a>

Плотность населения КНР
![alt text](images/image.png)